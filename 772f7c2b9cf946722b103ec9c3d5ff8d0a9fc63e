{
  "comments": [
    {
      "key": {
        "uuid": "3a65312a_d0d60fc5",
        "filename": "interfacemanager/interfacemanager-impl/src/main/java/org/opendaylight/genius/interfacemanager/servicebindings/flowbased/utilities/FlowBasedServicesUtils.java",
        "patchSetId": 8
      },
      "lineNbr": 287,
      "author": {
        "id": 817
      },
      "writtenOn": "2016-11-03T07:03:54Z",
      "side": 1,
      "message": "I have a concern on calling this from here. This method is getting called for each of the services bound on the interface, since we do check for the service index, it will not cause any harm, but do we really need it? If we program the splithorizonflow with the default service index, it will be the last executed flow in 220.. is that the expectation? or is it okaay to have an entry with highest service priority to drop the packet before even forwarding to egress services? This is just a question..I am not sure about the requirement.",
      "revId": "772f7c2b9cf946722b103ec9c3d5ff8d0a9fc63e",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "3a65312a_c325abac",
        "filename": "interfacemanager/interfacemanager-impl/src/main/java/org/opendaylight/genius/interfacemanager/servicebindings/flowbased/utilities/FlowBasedServicesUtils.java",
        "patchSetId": 8
      },
      "lineNbr": 287,
      "author": {
        "id": 670
      },
      "writtenOn": "2016-11-03T10:30:02Z",
      "side": 1,
      "message": "I thought you were bothered (correctly so) by installFlow being called per-service. This was the method to just install it once for the default service, otherwise we will call it multiple times even if with the same flow.\n\nWe could have put the rule for the first service today.. but theoretically I think in the future one of the egress services *could* want to unset the SH bit. Since we only have one egress service (ACL) today, not entirely sure what the correct approach is. Leaving it with the default is ok I think.",
      "parentUuid": "3a65312a_d0d60fc5",
      "revId": "772f7c2b9cf946722b103ec9c3d5ff8d0a9fc63e",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "3a65312a_c3112bae",
        "filename": "interfacemanager/interfacemanager-impl/src/main/java/org/opendaylight/genius/interfacemanager/servicebindings/flowbased/utilities/FlowBasedServicesUtils.java",
        "patchSetId": 8
      },
      "lineNbr": 287,
      "author": {
        "id": 817
      },
      "writtenOn": "2016-11-03T10:59:53Z",
      "side": 1,
      "message": "Got it, if there is a possibility of egress service unsetting it, this is the right approach",
      "parentUuid": "3a65312a_c325abac",
      "revId": "772f7c2b9cf946722b103ec9c3d5ff8d0a9fc63e",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "3a65312a_b0c71312",
        "filename": "interfacemanager/interfacemanager-impl/src/main/java/org/opendaylight/genius/interfacemanager/servicebindings/flowbased/utilities/FlowBasedServicesUtils.java",
        "patchSetId": 8
      },
      "lineNbr": 345,
      "author": {
        "id": 817
      },
      "writtenOn": "2016-11-03T07:03:54Z",
      "side": 1,
      "message": "can\u0027t we use matches \u003d FlowBasedServicesUtils.getMatchInfoForEgressDispatcherTable(interfaceTag, currentServiceIndex); and then append split horizon match to this?",
      "revId": "772f7c2b9cf946722b103ec9c3d5ff8d0a9fc63e",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "3a65312a_c3464b23",
        "filename": "interfacemanager/interfacemanager-impl/src/main/java/org/opendaylight/genius/interfacemanager/servicebindings/flowbased/utilities/FlowBasedServicesUtils.java",
        "patchSetId": 8
      },
      "lineNbr": 345,
      "author": {
        "id": 670
      },
      "writtenOn": "2016-11-03T10:30:02Z",
      "side": 1,
      "message": "Yeah, fixed, needed to change return type of getMatchInfoForEgress otherwise .add of metadata didn\u0027t work",
      "parentUuid": "3a65312a_b0c71312",
      "revId": "772f7c2b9cf946722b103ec9c3d5ff8d0a9fc63e",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "3a65312a_504b1fb0",
        "filename": "interfacemanager/interfacemanager-impl/src/main/java/org/opendaylight/genius/interfacemanager/servicebindings/flowbased/utilities/FlowBasedServicesUtils.java",
        "patchSetId": 8
      },
      "lineNbr": 354,
      "author": {
        "id": 817
      },
      "writtenOn": "2016-11-03T07:03:54Z",
      "side": 1,
      "message": "service priority and flow priority are two different things. Making flowpriority greater than service priority will not help the problem you are sloving..Also there is no need to do this.. Actual egress flow will match only register value..Since split horizon flow is having a match on ingress metadata as well, what is the problem even if this is lower priority?",
      "revId": "772f7c2b9cf946722b103ec9c3d5ff8d0a9fc63e",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "3a65312a_63c49740",
        "filename": "interfacemanager/interfacemanager-impl/src/main/java/org/opendaylight/genius/interfacemanager/servicebindings/flowbased/utilities/FlowBasedServicesUtils.java",
        "patchSetId": 8
      },
      "lineNbr": 354,
      "author": {
        "id": 670
      },
      "writtenOn": "2016-11-03T10:30:02Z",
      "side": 1,
      "message": "I saw the third parameter on buildFlowNew is the priority.. this is used for the flow priority, no?\n\nThe priority used for this is boundService.getServicePriority()..\n\nWe need to have this as a higher priority flow, otherwise OVS can arbitrarily choose one of the flows - it doesn\u0027t choose the most exact match if they both have the same priority.",
      "parentUuid": "3a65312a_504b1fb0",
      "revId": "772f7c2b9cf946722b103ec9c3d5ff8d0a9fc63e",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "3a65312a_632017f8",
        "filename": "interfacemanager/interfacemanager-impl/src/main/java/org/opendaylight/genius/interfacemanager/servicebindings/flowbased/utilities/FlowBasedServicesUtils.java",
        "patchSetId": 8
      },
      "lineNbr": 354,
      "author": {
        "id": 817
      },
      "writtenOn": "2016-11-03T10:59:53Z",
      "side": 1,
      "message": "Okaay..i was thinking OVS will match on the most matching flow. just noticed that flow priority is being taken as service priority, actually there is a separate flow-priority in yang model, (interface-service-bindings.yang), however it is not being used :) it is a bug in the existing code",
      "parentUuid": "3a65312a_504b1fb0",
      "revId": "772f7c2b9cf946722b103ec9c3d5ff8d0a9fc63e",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    }
  ]
}