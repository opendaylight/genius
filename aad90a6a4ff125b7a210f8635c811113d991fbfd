{
  "comments": [
    {
      "key": {
        "uuid": "16ee52a0_c870b2e2",
        "filename": "mdsalutil/mdsalutil-impl/src/main/java/org/opendaylight/genius/mdsalutil/internal/UpgradeStateListener.java",
        "patchSetId": 1
      },
      "lineNbr": 60,
      "author": {
        "id": 817
      },
      "writtenOn": "2018-08-29T05:14:58Z",
      "side": 1,
      "message": "is this a local variable? Or does this read from DS? If local, will this be broken if the listener is not clustered?",
      "revId": "aad90a6a4ff125b7a210f8635c811113d991fbfd",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "e2bee4cd_aaa8f869",
        "filename": "mdsalutil/mdsalutil-impl/src/main/java/org/opendaylight/genius/mdsalutil/internal/UpgradeStateListener.java",
        "patchSetId": 1
      },
      "lineNbr": 60,
      "author": {
        "id": 4540
      },
      "writtenOn": "2018-08-29T08:05:25Z",
      "side": 1,
      "message": "It\u0027s the AtomicBoolean declared at the top of the class; the get() is local.",
      "parentUuid": "16ee52a0_c870b2e2",
      "revId": "aad90a6a4ff125b7a210f8635c811113d991fbfd",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "f62656f8_24ae5fde",
        "filename": "mdsalutil/mdsalutil-impl/src/main/java/org/opendaylight/genius/mdsalutil/internal/UpgradeStateListener.java",
        "patchSetId": 1
      },
      "lineNbr": 60,
      "author": {
        "id": 817
      },
      "writtenOn": "2018-08-29T14:10:51Z",
      "side": 1,
      "message": "Then how will this work, in a cluster? if we make the listener non-clustered?",
      "parentUuid": "e2bee4cd_aaa8f869",
      "revId": "aad90a6a4ff125b7a210f8635c811113d991fbfd",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "ad754aa8_c8681792",
        "filename": "mdsalutil/mdsalutil-impl/src/main/java/org/opendaylight/genius/mdsalutil/internal/UpgradeStateListener.java",
        "patchSetId": 1
      },
      "lineNbr": 60,
      "author": {
        "id": 1842
      },
      "writtenOn": "2018-08-29T14:33:52Z",
      "side": 1,
      "message": "I see your point - we\u0027re caching state so need to be notified of changes on every node. This class also rolls the isUpgradeInProgress flag in the Config model to the same flag in the UpgradeConfig model - on a side note, why is this flag represented and duplicated in 2 yang models? In any event, to avoid OLFE, either eliminate the cache and read from the DS in isUpgradeInProgress() so you can use non-clustered DTCL or use EOS or CSS to ensure only one writer in the cluster.",
      "parentUuid": "f62656f8_24ae5fde",
      "revId": "aad90a6a4ff125b7a210f8635c811113d991fbfd",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "99270abc_29c07210",
        "filename": "mdsalutil/mdsalutil-impl/src/main/java/org/opendaylight/genius/mdsalutil/internal/UpgradeStateListener.java",
        "patchSetId": 1
      },
      "lineNbr": 60,
      "author": {
        "id": 5867
      },
      "writtenOn": "2018-08-30T10:40:46Z",
      "side": 1,
      "message": "\u003e side note, why is this flag represented and duplicated \n\nsee https://jira.opendaylight.org/browse/GENIUS-190\n\n\u003e eliminate the cache and read from the DS in \n\nNOK for perf\n\n\u003e or use EOS or CSS to ensure only one writer in the cluster\n\nI dunno EOS but perhaps this would be the opportunity to learn it? ;-)\n\nWhat CSS - YOU are removing that, so shouldn\u0027t use, right?\n\nOn thinking this over more (funnny how such a \"simple\" thing is surprisingly complicated in clustering!), isn\u0027t the real underlying problem here that 2 things are mixed up?  The cached isUpgradeInProgress is one thing - and that needs a distributed listener.  Shouldn\u0027t we just use that DataStoreCache util thing, which internally uses a clustered listener, for that?  But applying that same flag to another model (i.e. writing) is another - but that part doesn\u0027t need to be clustered - or does it?",
      "parentUuid": "ad754aa8_c8681792",
      "revId": "aad90a6a4ff125b7a210f8635c811113d991fbfd",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "06096ce5_38c546de",
        "filename": "mdsalutil/mdsalutil-impl/src/main/java/org/opendaylight/genius/mdsalutil/internal/UpgradeStateListener.java",
        "patchSetId": 1
      },
      "lineNbr": 60,
      "author": {
        "id": 5357
      },
      "writtenOn": "2018-08-30T10:48:41Z",
      "side": 1,
      "message": "Tom, it\u0027s in two models because it\u0027s being transitioned from one place to the other.",
      "parentUuid": "99270abc_29c07210",
      "revId": "aad90a6a4ff125b7a210f8635c811113d991fbfd",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "172a5fcf_201f1323",
        "filename": "mdsalutil/mdsalutil-impl/src/main/java/org/opendaylight/genius/mdsalutil/internal/UpgradeStateListener.java",
        "patchSetId": 1
      },
      "lineNbr": 60,
      "author": {
        "id": 1842
      },
      "writtenOn": "2018-08-30T13:09:57Z",
      "side": 1,
      "message": "\u003e On thinking this over more (funnny how such a \"simple\" thing is\n \u003e surprisingly complicated in clustering!), isn\u0027t the real underlying\n \u003e problem here that 2 things are mixed up?  The cached\n \u003e isUpgradeInProgress is one thing - and that needs a distributed\n \u003e listener.  Shouldn\u0027t we just use that DataStoreCache util thing,\n \u003e which internally uses a clustered listener, for that?  But applying\n \u003e that same flag to another model (i.e. writing) is another - but\n \u003e that part doesn\u0027t need to be clustered - or does it?\n\nYou\u0027re exactly right. Use a clustered DTCL for the cache, ie DataObjectCache, and a non-clustered DTCL for updating the other model.",
      "parentUuid": "99270abc_29c07210",
      "revId": "aad90a6a4ff125b7a210f8635c811113d991fbfd",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "4baf8f56_5c2f088c",
        "filename": "mdsalutil/mdsalutil-impl/src/main/java/org/opendaylight/genius/mdsalutil/internal/UpgradeStateListener.java",
        "patchSetId": 1
      },
      "lineNbr": 60,
      "author": {
        "id": 5867
      },
      "writtenOn": "2018-08-31T12:31:34Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "172a5fcf_201f1323",
      "revId": "aad90a6a4ff125b7a210f8635c811113d991fbfd",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    }
  ]
}