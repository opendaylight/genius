{
  "comments": [
    {
      "key": {
        "uuid": "9a245df4_5265cfdf",
        "filename": "itm/itm-impl/src/main/java/org/opendaylight/genius/itm/listeners/InterfaceStateListener.java",
        "patchSetId": 4
      },
      "lineNbr": 43,
      "author": {
        "id": 4540
      },
      "writtenOn": "2017-10-18T12:31:52Z",
      "side": 1,
      "message": "Since this is managed (at shutdown) by the instance, not the class, it should really be an instance field. I realise you’re doing this so that it can be provided to the superclass, and perhaps that’s a better compromise (it’s certainly closer to what I’d like with DI-managed executor services), but you need to deal with the fallout in shutdown().",
      "revId": "6a7166dc6896e0b80798019d1b96383aebb04100",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9a245df4_72dd7370",
        "filename": "itm/itm-impl/src/main/java/org/opendaylight/genius/itm/listeners/InterfaceStateListener.java",
        "patchSetId": 4
      },
      "lineNbr": 43,
      "author": {
        "id": 5861
      },
      "writtenOn": "2017-10-18T12:39:20Z",
      "side": 1,
      "message": "Yes, by using a class field we can assure the ExecutorService is created before passing it to the parent class. As you say, this is very close to what we can find in a DI-managed, since we have the executor already built for us.",
      "parentUuid": "9a245df4_5265cfdf",
      "revId": "6a7166dc6896e0b80798019d1b96383aebb04100",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9a245df4_b2becbfd",
        "filename": "itm/itm-impl/src/main/java/org/opendaylight/genius/itm/listeners/InterfaceStateListener.java",
        "patchSetId": 4
      },
      "lineNbr": 107,
      "author": {
        "id": 5861
      },
      "writtenOn": "2017-10-18T12:39:20Z",
      "side": 1,
      "message": "Stephen, what do you mean by \"dealing with the shutdown\"?",
      "range": {
        "startLine": 106,
        "startChar": 3,
        "endLine": 107,
        "endChar": 36
      },
      "revId": "6a7166dc6896e0b80798019d1b96383aebb04100",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9a245df4_523caf2f",
        "filename": "itm/itm-impl/src/main/java/org/opendaylight/genius/itm/listeners/InterfaceStateListener.java",
        "patchSetId": 4
      },
      "lineNbr": 107,
      "author": {
        "id": 4540
      },
      "writtenOn": "2017-10-18T14:16:42Z",
      "side": 1,
      "message": "The shutdown contract doesn’t say much about its behaviour, and with this approach, if for whatever reason we end up with multiple instances of the listener, we’ll shut the executor service down several times (admittedly, this shouldn’t happen, but the listener *implementation* doesn’t prevent it). So unless all executor services are idempotent on shutdown, we need to handle shared instances properly, with a reference count probably.",
      "parentUuid": "9a245df4_b2becbfd",
      "range": {
        "startLine": 106,
        "startChar": 3,
        "endLine": 107,
        "endChar": 36
      },
      "revId": "6a7166dc6896e0b80798019d1b96383aebb04100",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9a245df4_f2604337",
        "filename": "itm/itm-impl/src/main/java/org/opendaylight/genius/itm/listeners/InterfaceStateListener.java",
        "patchSetId": 4
      },
      "lineNbr": 107,
      "author": {
        "id": 5861
      },
      "writtenOn": "2017-10-18T14:39:48Z",
      "side": 1,
      "message": "With the current approach, the listeners fw hands over the shutdown policy to the specific listeners, so I\u0027d say we are done (by now) with the fw and with this change in particular, right?",
      "parentUuid": "9a245df4_523caf2f",
      "range": {
        "startLine": 106,
        "startChar": 3,
        "endLine": 107,
        "endChar": 36
      },
      "revId": "6a7166dc6896e0b80798019d1b96383aebb04100",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9a245df4_52866fba",
        "filename": "itm/itm-impl/src/main/java/org/opendaylight/genius/itm/listeners/InterfaceStateListener.java",
        "patchSetId": 4
      },
      "lineNbr": 107,
      "author": {
        "id": 4540
      },
      "writtenOn": "2017-10-18T14:55:39Z",
      "side": 1,
      "message": "Let me put it another way: what happens on bundle restart? @Singleton beans shouldn’t have any shared state, and if they do, they have to make it work as if it were non-shared. (We’re discussing a specific listener here, not the framework.)",
      "parentUuid": "9a245df4_f2604337",
      "range": {
        "startLine": 106,
        "startChar": 3,
        "endLine": 107,
        "endChar": 36
      },
      "revId": "6a7166dc6896e0b80798019d1b96383aebb04100",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9a245df4_2d455e70",
        "filename": "itm/itm-impl/src/main/java/org/opendaylight/genius/itm/listeners/InterfaceStateListener.java",
        "patchSetId": 4
      },
      "lineNbr": 107,
      "author": {
        "id": 5861
      },
      "writtenOn": "2017-10-18T17:58:07Z",
      "side": 1,
      "message": "Are we fine then with the changes proposed for the framework included within this commit?",
      "parentUuid": "9a245df4_52866fba",
      "range": {
        "startLine": 106,
        "startChar": 3,
        "endLine": 107,
        "endChar": 36
      },
      "revId": "6a7166dc6896e0b80798019d1b96383aebb04100",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9a245df4_12b51231",
        "filename": "itm/itm-impl/src/main/java/org/opendaylight/genius/itm/listeners/InterfaceStateListener.java",
        "patchSetId": 4
      },
      "lineNbr": 107,
      "author": {
        "id": 4540
      },
      "writtenOn": "2017-10-19T08:57:26Z",
      "side": 1,
      "message": "The framework changes are OK, we just need to handle shutdown properly in InterfaceStateListener.",
      "parentUuid": "9a245df4_2d455e70",
      "range": {
        "startLine": 106,
        "startChar": 3,
        "endLine": 107,
        "endChar": 36
      },
      "revId": "6a7166dc6896e0b80798019d1b96383aebb04100",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9a245df4_1bdc06e4",
        "filename": "itm/itm-impl/src/main/java/org/opendaylight/genius/itm/listeners/InterfaceStateListener.java",
        "patchSetId": 4
      },
      "lineNbr": 107,
      "author": {
        "id": 1842
      },
      "writtenOn": "2017-10-21T15:32:07Z",
      "side": 1,
      "message": "I agree with Stephen - this should not be static - they are generally problematic in OSGi.  This bundle would not be \"restartable\". There\u0027s a lot of statics and static wiring throughout  genius and netvirt which I\u0027m trying to cleanup.",
      "parentUuid": "9a245df4_12b51231",
      "range": {
        "startLine": 106,
        "startChar": 3,
        "endLine": 107,
        "endChar": 36
      },
      "revId": "6a7166dc6896e0b80798019d1b96383aebb04100",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9a245df4_d2a09ff6",
        "filename": "mdsalutil/mdsalutil-api/src/main/java/org/opendaylight/genius/datastoreutils/listeners/AbstractDataTreeChangeListener.java",
        "patchSetId": 4
      },
      "lineNbr": 53,
      "author": {
        "id": 4540
      },
      "writtenOn": "2017-10-18T12:31:52Z",
      "side": 1,
      "message": "Is this needed?",
      "revId": "6a7166dc6896e0b80798019d1b96383aebb04100",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9a245df4_52c14f7f",
        "filename": "mdsalutil/mdsalutil-api/src/main/java/org/opendaylight/genius/datastoreutils/listeners/AbstractDataTreeChangeListener.java",
        "patchSetId": 4
      },
      "lineNbr": 53,
      "author": {
        "id": 5861
      },
      "writtenOn": "2017-10-18T12:39:20Z",
      "side": 1,
      "message": "It is already there by this change https://git.opendaylight.org/gerrit/#/c/63800/, but I can remove it in a later patch, once we agree on the shutdown thing.",
      "parentUuid": "9a245df4_d2a09ff6",
      "revId": "6a7166dc6896e0b80798019d1b96383aebb04100",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    }
  ]
}